function cAttack(e,t,a,n,o,r){this.origin_x=parseInt(e),this.origin_y=parseInt(t),this.current_x=this.origin_x,this.current_y=this.origin_y,this.teamname=a,this.members=n,this.flag=o,this.score=parseFloat(r),this.fadein=!0,this.fadeout=!1,this.wait=!1,this.fadein_original=50,this.fadeout_original=20,this.wait_original=25,this.fadein_current=this.fadein_original,this.fadeout_current=this.fadeout_original,this.wait_current=this.wait_original,this.get_alpha=function(){return this.fadein?1-this.fadein_current/this.fadein_original:this.fadeout?this.fadeout_current/this.fadeout_original:1},this.get_origin_x=function(){return this.origin_x},this.get_origin_y=function(){return this.origin_y},this.get_current_x=function(){return this.current_x},this.get_current_y=function(){return this.current_y},this.get_members=function(){return this.members},this.get_teamname=function(){return this.teamname},this.get_flag=function(){return this.flag},this.get_score=function(){return this.score},this.update=function(){if(this.fadein)this.fadein_current--<1&&(this.fadein=!1);else if(this.wait)this.wait_current--<1&&(this.wait=!1,this.fadeout=!0);else if(this.fadeout){if(this.fadeout_current--<1)return!0}else this.current_x<Math.floor(world_width/2)?this.current_x++:this.current_x>Math.floor(world_width/2)?this.current_x--:this.current_y<Math.floor(world_height/2)?this.current_y++:this.current_y>Math.floor(world_height/2)?this.current_y--:this.wait=!0;return!1}}function cExplosion(e,t,a,n,o){this.x=e,this.y=t,this.maxsize=a,this.maxalpha=n,this.speed=o,this.size=0,this.get_x=function(){return this.x},this.get_y=function(){return this.y},this.get_maxsize=function(){return this.maxsize},this.get_size=function(){return this.size*o},this.get_alpha=function(){return(this.maxalpha-.1)*(this.get_size()/this.maxsize)+.1},this.update=function(){return this.get_size()<this.maxsize?(this.size++,!1):!0}}function rand_between(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function add_attack(e,t,a,n){var o=new Image;o.src="images/flags/"+a+".png";for(var r=rand_between(20,world_width-300),i=rand_between(20,world_height-100);Math.abs(world_width/2-r)<20||Math.abs(world_height/2-i)<20;)r=rand_between(20,world_width-300),i=rand_between(20,world_height-100);for(;325>r&&i>world_height-90;)r=rand_between(20,world_width-300),i=rand_between(20,world_height-100);attack_list.push(new cAttack(r,i,e,t,o,n))}function add_explosion(e,t,a,n,o){explosion_list.push(new cExplosion(e,t,a,n,o))}function clear(){context.clearRect(0,0,canvas.width,canvas.height)}function render(){clear(),attack_list.forEach(function(e){var t=e.get_alpha()*alpha_max;context.strokeStyle="#00EE00",context.fillStyle="rgba(0, 238, 0, "+t+")",context.globalAlpha=.6*t,context.drawImage(e.get_flag(),e.get_origin_x()+5,e.get_origin_y()+2),context.font="12px Ubuntu Mono",context.fillText("["+e.get_members()+"]",e.get_origin_x()+5,e.get_origin_y()+30),context.fillText(e.get_teamname(),e.get_origin_x()+27,e.get_origin_y()+14),context.fillText("["+e.get_current_x()+","+e.get_current_y()+"]",e.get_origin_x()+5,e.get_origin_y()+46),context.strokeStyle="#00cccc",context.globalAlpha=t,context.beginPath(),context.moveTo(e.get_current_x(),0),context.lineTo(e.get_current_x(),e.get_current_y()-3),context.moveTo(e.get_current_x(),e.get_current_y()+3),context.lineTo(e.get_current_x(),world_height-3),context.moveTo(0,e.get_current_y()),context.lineTo(e.get_current_x()-3,e.get_current_y()),context.moveTo(e.get_current_x()+3,e.get_current_y()),context.lineTo(world_width-3,e.get_current_y()),context.arc(e.get_current_x(),e.get_current_y(),10,0,2*Math.PI,!0),context.closePath(),context.stroke()}),explosion_list.forEach(function(e){var t=e.get_x(),a=e.get_y(),n=e.get_size(),o=e.get_alpha()*alpha_max;context.strokeStyle="#00EE00",context.fillStyle="rgba(0, 238, 0, 0.7)",context.globalAlpha=o,context.beginPath(),context.arc(t,a,n,0,2*Math.PI,!0),context.closePath(),context.stroke(),context.fill()})}function update(){attack_list.forEach(function(e,t,a){var n=e.update();n&&(add_explosion(e.get_current_x(),e.get_current_y(),Math.floor(20*constant*e.get_score()),rand_between(20,80)/100,rand_between(20,80)/100),delete e,a.splice(t,1),update_ranking())}),explosion_list.forEach(function(e,t,a){var n=e.update();n&&(delete e,a.splice(t,1))})}function animate(){setTimeout(function(){requestAnimationFrame(animate)},1),draw_animation&&(attack_list.length>0||explosion_list.length>0?(allow_requests=!1,render()):allow_requests||(clear(),allow_requests=!0))}function check_attacks(){var e=new FormData;e.append("last",last_attack),$.ajax({type:"POST",url:"ajax.php?m=get_attacks",data:e,processData:!1,contentType:!1,success:function(e){$(e).find("attack").each(function(){last_attack=$(this).find("id").text(),add_attack($(this).find("teamname").text(),$(this).find("members").text(),$(this).find("code").text(),$(this).find("score").text())})}})}function attack_wait(){allow_requests&&check_attacks(),setTimeout(function(){attack_wait()},get_update_rate())}function minimize_ranking(){var e=world_height-255;$("#rankingframe").animate({height:e+"px"},200),$("#scrollable").css("max-height",world_height-295+"px")}function maximize_ranking(){$("#rankingframe").animate({height:world_height+"px"},200),$("#scrollable").css("max-height",world_height-40+"px")}function update_ranking(){$.get("ajax.php?m=get_ranking",function(e){var t=$("<table>");$(e).find("team").each(function(){var e=$("<tr>");$("<td>").text($(this).find("rank").text()).appendTo(e),$("<td>").html('<img alt="flag" class="flagmove" src="images/flags/'+$(this).find("code").text()+'.png" alt="flag" />').appendTo(e),$("<td>").text($(this).find("name").text()).appendTo(e),$("<td>").addClass("score").text($(this).find("score").text()).appendTo(e),e.appendTo(t)}),$("#ranking").html(t.html())})}function set_sound(e){switch(e){case"1":localStorage.setItem("csc_allow_sound","true"),allow_sound=!0;break;case"0":localStorage.setItem("csc_allow_sound","false"),allow_sound=!1;break;default:1==allow_sound?(localStorage.setItem("csc_allow_sound","false"),allow_sound=!1,terminaldata="Turning sound off."):(localStorage.setItem("csc_allow_sound","true"),allow_sound=!0,terminaldata="Turning sound on.")}}function set_cat(e){switch(e){case"1":localStorage.setItem("csc_allow_cat","true"),allow_cat=!0;break;case"0":localStorage.setItem("csc_allow_cat","false"),allow_cat=!1;break;default:1==allow_cat?(localStorage.setItem("csc_allow_cat","false"),allow_cat=!1,terminaldata="Turning HackerCat off."):(localStorage.setItem("csc_allow_cat","true"),allow_cat=!0,terminaldata="Turning HackerCat on.")}}function play_sound(e,t){myAudio=new Audio(e),myAudio.addEventListener("ended",function(){this.currentTime=0,allow_sound&&t&&this.play()},!1),allow_sound&&myAudio.play()}function check_ticker(){$.get("ajax.php?m=get_message",function(xml){$(xml).find("announcement").each(function(){var id=$(this).find("id").text();if(id&&id!=last_message&&!cat_active){last_message=id,ticker_active=!0,show_message($(this).find("text").text(),$(this).find("image").text());try{eval($(this).find("script").text())}catch(e){}}})})}function show_message(e,t){$("#tickerframe").html('<p id="ticker"></p>'),$("#ticker").html('<span class="type"></span>'),$(".type").typed({strings:[e,"End Transmission"],typeSpeed:40,backDelay:200*e.length,callback:function(){reset_ticker(!1)}}),$("#announcements").css("display","inline-block"),$("#announcements").css("background-image","url(images/avatars/"+t+")"),minimize_ranking()}function show_cat(e){$("#tickerframe").html('<p id="ticker"></p>'),$("#ticker").html('<span class="type"></span>'),$(".type").typed({strings:[e,"Meow, Meow."],typeSpeed:30,backDelay:150*e.length,callback:function(){reset_ticker(!0)}}),$("#announcements").css("display","inline-block"),$("#announcements").css("background-image","url(images/avatars/cat.png)");var t=Math.floor(e.length/3);$("#announcements").animate({"border-spacing":t},{step:function(e,t){$(t.elem).css("background-position","0px "+e+"px")},duration:5e3}),minimize_ranking()}function reset_ticker(e){$("#announcements").fadeOut("slow",function(){maximize_ranking()}),e?cat_active=!1:ticker_active=!1}function ticker_wait(){allow_requests&&check_ticker(),setTimeout(function(){ticker_wait()},Math.floor(1.2*get_update_rate()))}function clear_mainframe(e){e?($("#challenges").hide(),$("#submit").hide(),$("#authenticate").hide(),$("#terminal").hide(),$(".separator","#menu").hide(),$("#close").show(),$("#innercontent").empty(),$("#innercontent").css("display","inline-block"),alpha_max=.1,$("#world").css({"background-image":"url(../images/backgrounds/milky.png), url(../images/backgrounds/shield.jpg)","background-repeat":"repeat, no-repeat","background-position":"center center","background-size":"auto, cover"})):($("#challenges").show(),$("#submit").show(),$("#authenticate").show(),$("#terminal").show(),$(".separator","#menu").show(),$("#close").hide(),$("#innercontent").empty(),$("#innercontent").css("display","none"),alpha_max=1,$("#world").css({"background-image":"url(../images/backgrounds/shield.jpg)","background-repeat":"no-repeat","background-size":"cover","background-position":"center center"}))}function toggle_color(e,t){var a=$(e).css("color");$(e).css("color",t),setTimeout(function(){$(e).css("color",a)},300)}function view_messages(){clear_mainframe(!0);var e=$("<div>").attr("id","basicframe").appendTo($("#innercontent")),t=($("<h1>").text("All System Messages and Hints").appendTo($(e)),$("<div>").attr("id","basicinner").appendTo($(e))),a=$("<ul>").appendTo($(t));$.get("ajax.php?m=view_messages",function(e){$(e).find("text").each(function(){$("<li>").html($(this).text()).appendTo($(a))})})}function view_team_attacks(){clear_mainframe(!0);var e=$("<div>").attr("id","basicframe").appendTo($("#innercontent")),t=($("<h1>").text("Last 50 Team-Team Attacks").appendTo($(e)),$("<div>").attr("id","basicinner").appendTo($(e))),a=$("<ul>").appendTo($(t));$.get("ajax.php?m=view_team_attacks",function(e){$(e).find("attack").each(function(){var e=$(this).find("from").text(),t=$(this).find("to").text(),n=$(this).find("value").text();if("1"==$(this).find("success").text()){var o=$("<li>").html(e+" successfully attacked "+t+" with "+n+" points.").appendTo($(a));o.css("color","green")}else{var o=$("<li>").html(e+" failed to attack "+t+" with "+n+" points.").appendTo($(a));o.css("color","red")}})})}function attack_team(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Attack Another Team").appendTo(t);var a=$("<label>").text("Team").appendTo(t);$("<span>").addClass("small").text("Attack Destination").appendTo(a);var n=$("<select>").attr("id","team").appendTo(t),o=new FormData;o.append("get","3"),o.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=get_attack_team",data:o,processData:!1,contentType:!1,success:function(e){$(e).find("team").each(function(){{var e=$(this).find("name").text(),t=$(this).find("id").text();$("<option>").val(t).text(e).appendTo(n)}})}});var r=$("<label>").text("Points").appendTo(t);$("<span>").addClass("small").text("Attack Size").appendTo(r),$("<input>").attr("type","text").attr("id","points").appendTo(t),$("<button>").attr("type","submit").text("Send").appendTo(t);var i=$("<p>").attr("class","response").appendTo($("#innercontent")),o=new FormData;o.append("get","2"),o.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=get_attack_team",data:o,processData:!1,contentType:!1,success:function(e){$(e).each(function(){var e=$(this).find("money").text();i.empty(),i.append("Your team currently has "+e+" attack points.")})}});var s=$("<p>").attr("class","response").appendTo($("#innercontent"));t.submit(function(){var e=new FormData;return e.append("to",$("#team").prop("value")),e.append("points",$("#points").prop("value")),e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=attack_team",data:e,processData:!1,contentType:!1,success:function(e){var t=$(e).find("text").text(),a=$(e).find("money").text(),n=$(e).find("new_score").text();switch(s.empty(),i.empty(),i.append("Your team currently has "+a+" attack points."),$(e).find("code").text()){case"1":s.append(t),s.css("color","blue");break;case"2":s.append("The attack was successfully executed! "+$("#team").find(":selected").text()+" now has "+n+" points."),s.css("color","green");break;case"3":s.append("The attack failed!"),s.css("color","red")}}}),!1})}function view_fails(){clear_mainframe(!0);var e=($("<div>").attr("id","basicframe").appendTo($("#innercontent")),$("<h1>").text("Le Fail Counter").appendTo($("#basicframe")),$("<div>").attr("id","basicinner").appendTo($("#basicframe"))),t=($("<p>").text("How many times did your team submit a wrong flag?").appendTo($(e)),$("<ul>").appendTo($(e)));$.get("ajax.php?m=view_fails",function(e){$(e).find("team").each(function(){{var e=$(this).find("name").text(),a=$(this).find("fails").text();$("<li>").text(e+" - "+a+" times").appendTo(t)}})})}function view_completed(){clear_mainframe(!0);$("<div>").attr("id","basicframe").appendTo($("#innercontent")),$("<h1>").text("Strategic Challenge Planner").appendTo($("#basicframe")),$("<div>").attr("id","basicinner").appendTo($("#basicframe"));$.get("ajax.php?m=view_completed",function(e){var t=$("<table>"),a=$("<tr>");$("<th>").text("Team Name").appendTo(a),$("<th>").text("Completed Challenge(s)").appendTo(a),a.appendTo(t),$(e).find("team").each(function(){var e=$("<tr>");$("<td>").text($(this).find("name").text()).appendTo(e),$("<td>").text($(this).find("t").text()).appendTo(e),e.appendTo(t)}),$("#basicinner").html(t.html())})}function page_challenges(){clear_mainframe(!0);var e=$("<div>").attr("id","challengesframe").appendTo($("#innercontent")),t=($("<div>").attr("id","challengeframe").appendTo($("#innercontent")),$("<ul>").appendTo(e));$.get("ajax.php?m=get_challenges",function(e){$(e).find("category").each(function(){var e=$("<li>").addClass("category").text($(this).find("name").text()).appendTo(t),a=$("<ul>").appendTo(e);$(this).find("challenge").each(function(){var e=$(this).find("id").text(),t=$(this).find("title").text(),n=$(this).find("score").text(),o=$("<li>").addClass("challenge").text(t+" ("+n+")").appendTo(a);o.click(function(){open_challenge(e)});var r=$(this).find("solved").text(),i=$(this).find("deactivated").text();o.addClass("1"==r?"solved":"1"==i?"deactivated":"notsolved")})})})}function open_challenge(e){$("#challengeframe").empty();var t=new FormData;t.append("id",e),$.ajax({type:"POST",url:"ajax.php?m=get_challenge",data:t,processData:!1,contentType:!1,success:function(e){$("<h1>").text($(e).find("title").text()).appendTo($("#challengeframe"));$("<span>").html($(e).find("description").text()).appendTo($("#challengeframe"))}})}function page_submit(){clear_mainframe(!0);var formframe=$("<div>").attr("id","formframe").addClass("flags").appendTo($("#innercontent")),form=$("<form>").appendTo(formframe);$("<h1>").attr("id","header").text("Attack").appendTo(form);var label_flag=$("<label>").text("Flag").appendTo(form);$("<span>").addClass("small").text("Any challenge").appendTo(label_flag),$("<input>").attr("type","text").attr("id","flag").appendTo(form),$("<button>").attr("type","submit").text("Send").appendTo(form);var reply=$("<p>").attr("class","response").appendTo($("#innercontent"));form.submit(function(){var formData=new FormData;return formData.append("key",$("#flag").prop("value")),formData.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=submit_key",data:formData,processData:!1,contentType:!1,success:function(xml){var response=$(xml).find("text").text(),cat=$(xml).find("cat").text(),script=$(xml).find("script").text();if(allow_cat&&!cat_active&&!ticker_active){try{eval(script)}catch(e){}0!=cat.length&&(cat_active=!0,show_cat(cat))}switch($(xml).find("code").text()){case"1":reply.empty(),check_attacks(),response?(reply.append(response),setTimeout(function(){clear_mainframe(!1)},3e3)):clear_mainframe(!1);break;case"2":toggle_color($("#header"),"orange"),reply.empty(),reply.append(response);break;case"3":toggle_color($("#header"),"red"),reply.empty(),reply.append(response);break;case"4":toggle_color($("#header"),"blue"),reply.empty(),reply.append(response)}}}),!1})}function page_login(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Authenticate").appendTo(t);var a=$("<label>").text("Username").appendTo(t);$("<span>").addClass("small").text("Enter your teamname").appendTo(a),$("<input>").attr("type","text").attr("id","username").appendTo(t);var n=$("<label>").text("Password").appendTo(t);$("<span>").addClass("small").text("Enter your password").appendTo(n),$("<input>").attr("type","password").attr("id","password").appendTo(t),$("<button>").attr("type","submit").text("Login").appendTo(t);var o=$("<p>").attr("class","response").appendTo($("#innercontent"));t.submit(function(){var e=new FormData;return e.append("username",$("#username").prop("value")),e.append("password",$("#password").prop("value")),e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=login",data:e,processData:!1,contentType:!1,success:function(e){var t=$(e).find("text").text();switch($(e).find("code").text()){case"1":login(),clear_mainframe(!1);break;case"2":toggle_color($("#header"),"orange"),o.empty(),o.append(t);break;case"3":toggle_color($("#header"),"red"),o.empty(),o.append(t)}}}),!1})}function page_logout(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Authenticate").appendTo(t),$("<button>").attr("type","submit").text("Logout").appendTo(t),t.submit(function(){var e=new FormData;return e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=logout",data:e,processData:!1,contentType:!1,success:function(e){switch($(e).find("code").text()){case"1":logout(),clear_mainframe(!1);break;case"2":toggle_color($("#header"),"red")}}}),!1})}function update_flag(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").attr("method","POST").attr("enctype","multipart/form-data").appendTo(e);$("<h1>").attr("id","header").text("Update Flag").appendTo(t);var a=$("<label>").text("Flag").appendTo(t);$("<span>").addClass("small").text("Optional").appendTo(a),$("<input>").attr("type","file").attr("name","file").attr("id","file").attr("style","padding: 0;").appendTo(t),$("<button>").attr("type","submit").text("Send").appendTo(t);var n=$("<p>").attr("class","response").appendTo($("#innercontent"));t.submit(function(){var e=new FormData;return e.append("file",$("#file").get(0).files[0]),e.append("token",token),$.ajax({url:"ajax.php?m=update_flag",type:"POST",data:e,processData:!1,contentType:!1,success:function(e){var t=$(e).find("text").text();switch($(e).find("code").text()){case"1":toggle_color($("#header"),"green"),n.empty(),n.append(t),setTimeout(function(){location.reload(!0)},5e3);break;case"2":toggle_color($("#header"),"orange"),n.empty(),n.append(t);break;case"3":toggle_color($("#header"),"red"),n.empty(),n.append(t)}}}),!1})}function update_info(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Update Information").appendTo(t);var a=$("<label>").text("Member 1").appendTo(t);$("<span>").addClass("small").text("Optional").appendTo(a),$("<input>").attr("type","text").attr("id","m1").appendTo(t);var n=$("<label>").text("Member 2").appendTo(t);$("<span>").addClass("small").text("Optional").appendTo(n),$("<input>").attr("type","text").attr("id","m2").appendTo(t);var o=$("<label>").text("Member 3").appendTo(t);$("<span>").addClass("small").text("Optional").appendTo(o),$("<input>").attr("type","text").attr("id","m3").appendTo(t);var r=$("<label>").text("New Email").appendTo(t);$("<span>").addClass("small").text("Optional").appendTo(r),$("<input>").attr("type","text").attr("id","email").appendTo(t),$("<button>").attr("type","submit").text("Send").appendTo(t);var i=$("<p>").attr("class","response").appendTo($("#innercontent"));t.submit(function(){var e=new FormData;return e.append("m1",$("#m1").prop("value")),e.append("m2",$("#m2").prop("value")),e.append("m3",$("#m3").prop("value")),e.append("email",$("#email").prop("value")),e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=update_info",data:e,processData:!1,contentType:!1,success:function(e){var t=$(e).find("text").text();switch($(e).find("code").text()){case"1":toggle_color($("#header"),"green"),i.empty(),i.append(t),setTimeout(function(){location.reload(!0)},5e3);break;case"2":toggle_color($("#header"),"orange"),i.empty(),i.append(t);break;case"3":toggle_color($("#header"),"red"),i.empty(),i.append(t)}}}),!1})}function create_account(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Create Team").appendTo(t);var a=$("<label>").text("Team Name").appendTo(t);$("<span>").addClass("small").text("Same as log in").appendTo(a),$("<input>").attr("type","text").attr("id","team_name").appendTo(t);var n=$("<label>").text("School").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(n);var o=$("<select>").attr("id","school").appendTo(t);$("<option>").val("CAMS").text("CAMS").appendTo(o),$("<option>").val("Other").text("Other").appendTo(o);var r=$("<label>").text("Password").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(r),$("<input>").attr("type","password").attr("id","password").appendTo(t);var i=$("<label>").text("Confirm Password").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(i),$("<input>").attr("type","password").attr("id","repeat").appendTo(t);var s=$("<label>").text("Email").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(s),$("<input>").attr("type","text").attr("id","email").appendTo(t),$("<button>").attr("type","submit").text("Send").appendTo(t);var p=$("<p>").attr("class","response").appendTo($("#innercontent"));t.submit(function(){var e=new FormData;return e.append("team_name",$("#team_name").prop("value")),e.append("school",$("#school").val()),e.append("password",$("#password").prop("value")),e.append("repeat",$("#repeat").prop("value")),e.append("email",$("#email").prop("value")),e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=create_account",data:e,processData:!1,contentType:!1,success:function(e){var t=$(e).find("text").text();switch($(e).find("code").text()){case"1":toggle_color($("#header"),"green"),p.empty(),p.append(t),setTimeout(function(){location.reload(!0)},5e3);break;case"2":toggle_color($("#header"),"orange"),p.empty(),p.append(t);break;case"3":toggle_color($("#header"),"red"),p.empty(),p.append(t)}}}),!1})}function forgot_pass(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Forgot Password").appendTo(t);var a=$("<label>").text("Team Name").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(a),$("<input>").attr("type","text").attr("id","name").appendTo(t);var n=$("<label>").text("Email").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(n),$("<input>").attr("type","text").attr("id","email").appendTo(t),$("<button>").attr("type","submit").text("Send").appendTo(t);var o=$("<p>").attr("class","response").appendTo($("#innercontent"));t.submit(function(){var e=new FormData;return e.append("name",$("#name").prop("value")),e.append("email",$("#email").prop("value")),e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=forgot_pass",data:e,processData:!1,contentType:!1,success:function(e){var t=$(e).find("text").text();switch($(e).find("code").text()){case"1":toggle_color($("#header"),"green"),o.empty(),o.append(t),setTimeout(function(){clear_mainframe(!1)},5e3);break;case"2":toggle_color($("#header"),"orange"),o.empty(),o.append(t);break;case"3":toggle_color($("#header"),"red"),o.empty(),o.append(t)}}}),!1})}function change_pass(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Change Password").appendTo(t);var a=$("<label>").text("Current Password").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(a),$("<input>").attr("type","password").attr("id","current").appendTo(t);var n=$("<label>").text("New Password").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(n),$("<input>").attr("type","password").attr("id","new").appendTo(t);var o=$("<label>").text("Confirm Password").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(o),$("<input>").attr("type","password").attr("id","repeat").appendTo(t),$("<button>").attr("type","submit").text("Send").appendTo(t);var r=$("<p>").attr("class","response").appendTo($("#innercontent"));t.submit(function(){var e=new FormData;return e.append("current",$("#current").prop("value")),e.append("new",$("#new").prop("value")),e.append("repeat",$("#repeat").prop("value")),e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=change_pass",data:e,processData:!1,contentType:!1,success:function(e){var t=$(e).find("text").text();switch($(e).find("code").text()){case"1":toggle_color($("#header"),"green"),r.empty(),r.append(t),setTimeout(function(){clear_mainframe(!1)},5e3);break;case"2":toggle_color($("#header"),"orange"),r.empty(),r.append(t);break;case"3":toggle_color($("#header"),"red"),r.empty(),r.append(t)}}}),!1})}function page_sendmessage(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Send Message").appendTo(t);var a=$("<label>").text("Password").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(a),$("<input>").attr("type","password").attr("id","password").appendTo(t);var n=$("<label>").text("Message").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(n),$("<input>").attr("type","text").attr("id","message").appendTo(t);var o=$("<label>").text("Image").appendTo(t);$("<span>").addClass("small").text("Required").appendTo(o),$("<input>").attr("type","text").attr("id","image").appendTo(t);var r=$("<label>").text("Script").appendTo(t);$("<span>").addClass("small").text("Optional").appendTo(r),$("<input>").attr("type","text").attr("id","script").appendTo(t),$("<button>").attr("type","submit").text("Send").appendTo(t),t.submit(function(){var e=new FormData;return e.append("password",$("#password").prop("value")),e.append("message",$("#message").prop("value")),e.append("image",$("#image").prop("value")),e.append("script",$("#script").prop("value")),e.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=send_message",data:e,processData:!1,contentType:!1,success:function(e){switch($(e).find("code").text()){case"1":check_ticker(),clear_mainframe(!1);break;case"2":toggle_color($("#header"),"orange");break;case"3":toggle_color($("#header"),"red")}}}),!1})}function page_settings(){clear_mainframe(!0);var e=$("<div>").attr("id","formframe").appendTo($("#innercontent")),t=$("<form>").appendTo(e);$("<h1>").attr("id","header").text("Settings").appendTo(t);var a=$("<label>").text("Update rate").appendTo(t);$("<span>").addClass("small").text("Whatever").appendTo(a);var n=$("<select>").attr("id","updaterate").appendTo(t),o=$("<option>").attr("value","0").text("Slow").appendTo(n),r=$("<option>").attr("value","1").text("Normal").appendTo(n),i=$("<option>").attr("value","2").text("High").appendTo(n),s=$("<option>").attr("value","3").text("Very High").appendTo(n);switch(update_rate){case"0":o.attr("selected","selected");break;case"1":r.attr("selected","selected");break;case"2":i.attr("selected","selected");break;case"3":s.attr("selected","selected")}var p=$("<label>").text("Font Size").appendTo(t);$("<span>").addClass("small").text("Whatever").appendTo(p);var c=$("<select>").attr("id","fontsize").appendTo(t),d=$("<option>").attr("value","0").text("Small").appendTo(c),l=$("<option>").attr("value","1").text("Normal").appendTo(c),u=$("<option>").attr("value","2").text("Large").appendTo(c),m=$("<option>").attr("value","3").text("Extra Large").appendTo(c);switch(fontsize){case"0":d.attr("selected","selected");break;case"1":l.attr("selected","selected");break;case"2":u.attr("selected","selected");break;case"3":m.attr("selected","selected")}var h=$("<label>").text("HackerCat").appendTo(t);$("<span>").addClass("small").text("Meow, meow").appendTo(h);var f=$("<select>").attr("id","hcat").appendTo(t),_=$("<option>").attr("value","0").text("Off").appendTo(f),g=$("<option>").attr("value","1").text("On").appendTo(f);switch(allow_cat){case!1:_.attr("selected","selected");break;case!0:g.attr("selected","selected")}var x=$("<label>").text("Sound").appendTo(t);$("<span>").addClass("small").text("Silence").appendTo(x);var T=$("<select>").attr("id","sound").appendTo(t),w=$("<option>").attr("value","0").text("Off").appendTo(T),v=$("<option>").attr("value","1").text("On").appendTo(T);switch(allow_sound){case!1:w.attr("selected","selected");break;case!0:v.attr("selected","selected")}$("<button>").attr("type","submit").text("Send").appendTo(t),t.submit(function(){return set_update_rate($("#updaterate").val()),set_fontsize($("#fontsize").val()),set_cat($("#hcat").val()),set_sound($("#sound").val()),clear_mainframe(!1),!1})}function page_terminal(){terminal?($(terminal).remove(),terminal=!1):(terminal=generate_terminal(generate_box("Terminal")).appendTo($("body")),$(".terminal-input",terminal).focus())}function generate_box(e){{var t=$("<div>").addClass("container"),a=$("<div>").addClass("box"),n=$("<div>").addClass("box-header").appendTo(a);$("<div>").addClass("box-body").appendTo(a)}$("<h1>").text(e).appendTo(n);var o=$("<div>").addClass("box-navigation").appendTo(n),r=!1,i=offsetY=0;return n.mousedown(function(e){r=!0;var t=n.offset();i=e.pageX-t.left,offsetY=e.pageY-t.top}),$(document).mouseup(function(){r=!1}),$(document).mousemove(function(e){if(0!=r){var t=e.pageX-i,n=e.pageY-offsetY;a.css("left",t).css("top",n)}}),$("<img>").addClass("close").attr("src","images/icons/close_small.png").appendTo(o),a.appendTo(t),t}function generate_terminal(container){var output=$("<pre>").addClass("terminal-output"),frame=$("<div>").addClass("box-frame").append(output),input=$("<input>").attr("type","text").addClass("terminal-input"),submit=$("<input>").attr("type","submit").val("Send"),clear=$("<input>").attr("type","reset").val("Clear"),form=$("<form>").addClass("terminal-form");return form.append(input).append(submit).append(clear),$(".box-body",container).append(frame).append(form),submit.click(function(){var formData=new FormData;return formData.append("command",$(input).prop("value")),formData.append("token",token),$.ajax({type:"POST",url:"ajax.php?m=terminal",data:formData,processData:!1,contentType:!1,success:function(xml){var command=$(xml).find("command");try{eval(command.text())}catch(e){}terminaldata?(output.text(output.text()+"> "+$(xml).find("input").text()+"\n"+terminaldata+"\n"),terminaldata=""):output.text(output.text()+"> "+$(xml).find("input").text()+"\n"+$(xml).find("output").text()+"\n")}}),input.val(""),input.focus(),!1}),clear.click(function(){return input.val(""),output.text(""),!1}),$(".close",container).click(function(){page_terminal()}),container}function set_update_rate(e){switch(e){case"0":localStorage.setItem("csc_update_rate","0"),update_rate="0";break;case"1":localStorage.setItem("csc_update_rate","1"),update_rate="1";break;case"2":localStorage.setItem("csc_update_rate","2"),update_rate="2";break;case"3":localStorage.setItem("csc_update_rate","3"),update_rate="3"}}function get_update_rate(){switch(update_rate){default:case"0":return 3e4;case"1":return 1e4;
case"2":return 5e3;case"3":return 2500}}function set_fontsize(e){switch(e){case"0":localStorage.setItem("csc_font_size","0"),fontsize="0",$("#innercontent").css("font-size","90%");break;case"1":localStorage.setItem("csc_font_size","1"),fontsize="1",$("#innercontent").css("font-size","100%");break;case"2":localStorage.setItem("csc_font_size","2"),fontsize="2",$("#innercontent").css("font-size","110%");break;case"3":localStorage.setItem("csc_font_size","3"),fontsize="3",$("#innercontent").css("font-size","120%")}}function login(){loggedin=!0,$("#challenges").css("cursor","pointer"),$("#submit").css("cursor","pointer")}function logout(){loggedin=!1,$("#challenges").css("cursor","url(images/icons/disabled.png),auto"),$("#submit").css("cursor","url(images/icons/disabled.png),auto")}function load_session(){$.get("ajax.php?m=get_session",function(e){"1"==$(e).find("loggedin").text()?login():logout(),token=$(e).find("token").text()})}function check_ie(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return t>0||navigator.userAgent.match(/Trident.*rv\:11\./)?!1:!0}function check_cookies(){return navigator.cookieEnabled?!0:!1}function initialize(){$("#errors").css("display","none"),$("#content").css("display","inline-block"),canvas=document.getElementById("canvas"),canvas.width=world_width,canvas.height=world_height,context=canvas.getContext("2d"),attack_wait(),ticker_wait(),update_ranking(),localStorage.csc_update_rate||set_update_rate("1"),localStorage.csc_font_size||set_fontsize("1"),localStorage.csc_allow_cat||set_cat("1"),localStorage.csc_allow_sound||set_sound("1"),animate(),setInterval("update()",25)}function write_css(){world_height=b_height-70,world_width=b_width-400;var e=35;600>world_height&&(world_height=600,e=10),1e3>world_width&&(world_width=1e3),constant=world_height/600,$("#world").css({height:world_height,width:world_width}),$("#canvas").css({height:world_height,width:world_width,"margin-top":"-3px"}),$("#rankingframe").css({height:world_height-255}),$("#content").css({height:world_height,width:world_width+310,"margin-top":e}),$("#innercontent").css({height:world_height-70,width:world_width-20})}var attack_list=new Array,explosion_list=new Array,last_attack="0",last_message="0",allow_requests=!0,muted=!1,alpha_max=0,loggedin=!1,terminal=!1,token=!1,canvas=!1,context=!1,update_rate=localStorage.getItem("csc_update_rate"),draw_animation=!0,fontsize=localStorage.getItem("csc_font_size"),b_height=$(window).height(),b_width=$(window).width(),world_height=0,world_width=0,constant=0,allow_cat="true"==localStorage.getItem("csc_allow_cat"),allow_sound="true"==localStorage.getItem("csc_allow_sound"),cat_active=!1,ticker_active=!1,terminaldata="";$(document).ready(function(){return check_cookies()?check_ie()?(write_css(),load_session(),clear_mainframe(!1),$("#challenges").click(function(){loggedin&&page_challenges()}),$("#submit").click(function(){loggedin&&page_submit()}),$("#authenticate").click(function(){loggedin?page_logout():page_login()}),$("#terminal").click(function(){page_terminal()}),$("#close").click(function(){clear_mainframe(!1)}),$(document).keypress(function(e){(122==e.which&&e.ctrlKey||26==e.which)&&page_terminal()}),void initialize()):void $("<li>Seriously? Internet Explore? Please come back when you have a better browser such as <a href='http://www.google.com/intl/en_us/chrome/browser/' target='_blank'>Chrome</a> or <a href='http://www.mozilla.org/en-US/firefox/new/' target='_blank'>Firefox</a>.</li>").appendTo("#errors"):void $("<li>Please enable your browser's delicious cookie feature. Seriously. <a href='http://www.google.com/search?q=how+to+enable+cookies' target='_blank'>Help me Google!</a></li>").appendTo("#errors")});